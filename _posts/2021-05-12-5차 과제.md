# 머신러닝 5차 과제

## 과제 1

조기 종료를 사용한 배치 경사 하강법으로 로지스틱 회귀를 구현하라. 단, 사이킷런을 전혀 사용하지 않아야 한다.

### 기본 설정

 필수 모듈 불러오기

 그래프 출력 관련 기본 설정 지정

```python
#파이썬 ≥3.5 필수
import sys
assert sys.version_info >= (3, 5) 

#사이킷런 ≥0.20 필수
import sklearn
assert sklearn.__version__ >= "0.20"

#공통 모듈 임포트
import numpy as np
import os

#노트북 실행 결과를 동일하게 유지하기 위해
np.random.seed(42)

#깔끔한 그래프 출력을 위해
%matplotlib inline
import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.rc('axes', labelsize=14)
mpl.rc('xtick', labelsize=12)
mpl.rc('ytick', labelsize=12)

#그림을 저장할 위치
PROJECT_ROOT_DIR = "."
CHAPTER_ID = "svm"
IMAGES_PATH = os.path.join(PROJECT_ROOT_DIR, "images", CHAPTER_ID)
os.makedirs(IMAGES_PATH, exist_ok=True)

def save_fig(fig_id, tight_layout=True, fig_extension="png", resolution=300):
    path = os.path.join(IMAGES_PATH, fig_id + "." + fig_extension)
    print("그림 저장:", fig_id)
    if tight_layout:
        plt.tight_layout()
    plt.savefig(path, format=fig_extension, dpi=resolution)
   ```
   
### 데이터 준비
   
붓꽃 데이터셋의 꽃잎 길이와 꽃잎 너비 특성만 이용한다
   
```python
from sklearn import datasets
iris = datasets.load_iris()

iris.target

X = iris["data"][:, (2, 3)]                  # 꽃잎 길이와 너비
y = (iris["target"] == 2).astype(np.int)
```

#### 편향 추가

```python
X_with_bias = np.c_[np.ones([len(X), 1]), X]
```

#### 랜덤 시드 지정

```python
np.random.seed(2042)
```

### 데이터셋 분할

훈련 세트:60%

검증 세트:20%

테스트 세트:20%

```python
test_ratio = 0.2                                         # 테스트 세트 비율 = 20%
validation_ratio = 0.2                                   # 검증 세트 비율 = 20%
total_size = len(X_with_bias)                            # 전체 데이터셋 크기

test_size = int(total_size * test_ratio)                 # 테스트 세트 크기: 전체의 20%
validation_size = int(total_size * validation_ratio)     # 검증 세트 크기: 전체의 20%
train_size = total_size - test_size - validation_size    # 훈련 세트 크기: 전체의 60%
```

#### 인덱스 무작위로 섞기

```
rnd_indices = np.random.permutation(total_size)

X_train = X_with_bias[rnd_indices[:train_size]]
y_train = y[rnd_indices[:train_size]]

X_valid = X_with_bias[rnd_indices[train_size:-test_size]]
y_valid = y[rnd_indices[train_size:-test_size]]

X_test = X_with_bias[rnd_indices[-test_size:]]
y_test = y[rnd_indices[-test_size:]]

y_train[:5]
```

### 로지스틱 모델 구현

#### 시그모이드 함수 만들기

