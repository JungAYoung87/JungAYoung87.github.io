# 6 The universal workflow of machine learning

## 6.1 Define the task
당신은 당신이 하려는 일에 대한 깊은 이해없이는 작업을 잘 수행할 수 없다. 고객이 왜 이 특정 문제를 해결하려고 하는지, 솔루션으로 얻을 수 있는 가치가 무엇인지, 모델이 어떻게 사용되는지, 그것이 고객의 작업 절차에 잘 맞는지, 어떤 데이터가 유용하고 정확한지, 어떤 머신러닝 작업이 문제 해결에 적절한지 파악해야 한다.

### 6.1.1 Frame the problem
머신러닝 문제를 정의하기 위해서 섬세한 고민들이 필요하다.

몇가지 질문을 던져볼 수 있다.

-당신의 입력 데이터는 무엇이며, 무엇을 예측하고자 하는가?

  당신은 사용 가능한 훈련 데이터가 있는 경우에만 무언가를 예측하는 방법을 배울 수 있다.
 
-어떤 유형의 머신러닝 작업에 직면하고 있는가?

  어떤 경우에는 머신러닝이 데이터를 이해하는 가장 좋은 방법이 아닐 수 있으며, 단순한 통계분석과 같은 다른 것을 사용해야 할 수도 있다.
 
-기존 솔루션은 어떻게 생겼는가?

  어떤 시스템이 이미 설치되어 있고 어떻게 작동하는지 확실히 이해해야 한다.
 
-처리해야 하는 특정 제약 조건이 있는가?

  당신은 당신의 작업이 적합하도록 전체의 맥락을 이해해야 한다.
 
 조사를 마치고나면 광범위한 유형의 머신러닝 작업을 알아야 한다. 이 단계에서는 다음 가설을 주의해야 한다.
 
 -입력이 주어지면 타깃을 예측할 수 있다는 가정
 
 -사용 가능한 데이터가 입력과 타깃 간의 관계를 학습하기에 충분히 유용하다는 가정
 
머신러닝으로 모든 문제를 해결할 수 있는 것은 아니며 수집한 데이터가 반드시 예측에 충분한 것은 아니기 때문에 주의해야한다.

### 6.1.2. Collect a dataset

작업을 이해하고 입력과 대상이 무엇인지 알게되면 데이터 수집을 할 때이다. 대부분의 머신러닝 프로젝트에서 가장 힘들고 시간이 많이 걸리며 비용이 많이 드는 부분이다.

모델의 일반화 능력은 전적으로 모델이 보유한 데이터 수, 레이블의 신뢰성, 기능의 품질에 대해 훈련된 데이터의 속성에서 비롯된다.

딥러닝의 부상으로 데이터의 중요성은 커지고 있다.

지도학습을 수행하는 경우 입력을 수집하면 해당 입력에 대한 주석(모델을 학습하여 예측할 대상)이 필요하다.

데이터 주석 프로세스는 대상의 품질을 결정하고 이는 차례로 모델의 품질을 결정한다. 사용 가능한 옵션을 신중하게 고려하여 투자해야 한다.

최상의 옵션을 선택하려면 작업 중인 제약 조건을 고려해야한다.

-data labeler가 주제에 대한 전문가가 되어야하는가 아니면 데이터에 주석을 달 수 있는 사람이 있는가
-데이터에 주석을 추가하는 데 전문지식이 필요한 경우 관련 교육을 할 수 있는가, 그렇지 않담녀 관련 전문가에게 접근할 수 있는가
-전문가가 주석을 작성하는 방식을 이해하고 있는가

내부에서 데이터에 레이블을 지정하기로 결정했다면 주석을 기록하는 데 어떤 소프트웨어를 사용할 것인지 생각해보아야 한다. 해당 소프트웨어를 직접 개발해야 할 수도 있다.

생산적인 데이터는 많을 시간을 절약할 수 있으므로 프로젝트 초기에 투자할 가치가 있다.

#### 대표성이 없는 데이터에 주의

머신러닝 모델은 이전에 본 것과 유사한 입력만 이해할 수 있다. 따라서 훈련에 사용되는 데이터는 생산데이터를 대표해야 하며 이 문제는 모든 데이터 수집 작업의 기초가 된다.

가능하면 모델이 사용될 환경에서 직접 데이터를 수집하는 것이 좋다. 생산 데이터에 대해 학습할 수 없는 경우에는 훈련데이터와 생산 데이터가 어떻게 다른지 이해하고 차이점을 적극적으로 수정하고 있는지 확인해야 한다.

관련하여 concept drift에 대해 알고 있어야 한다. 사용자가 생산 데이터를 다루는 문제에서 발생하는데 생산 데이터의 속성이 시간이 지남에 따라 변경되어 모델 정확도가 점차 저하될 때 발생한다.

머신러닝은 훈련데이터에 있는 패턴을 기억하는 데만 사용할 수 있다는 점을 기억해야한다. 과거 데이터에 대해 훈련된 머신러닝을 사용하여 미래를 예측하는 것은 정확하지 않은 경우가 많다.

##### Note:The problem of sanpling bias

데이터에 대표성이 없는 경우는 샘플링 편향이다. 샘플링 편향은 데이터 수집 프로세스가 예측하려는 대상과 상호작용하여 편향된 측정이 발생할 때 발생한다.

## 6.1.3 Understand your data

모델 훈련을 시작하기 전에 데이터를 탐색하고 시각화하여 예측 가능한 요소에 대한 통찰력을 얻고 기능 엔지니어링에 정보를 제공하고 잠재적인 문제를 선별해야한다.

데이터에 이미지나 자연어 텍스트가 포함된 경우 몇 가지 샘플을 직접 살펴보고, 데이터에 수치적 특성이 포함된 경우 특성 값의 히스토그램을 그려서 취한값의 범위와 다른 값의 빈도를 파악하는 것이 좋다.

위치 정보가 포함된 경우 지도에 표시한다. 

일부 샘플에서 일부 기능의 값이 누락되었다면 이 문제도 처리해야 한다.

작업이 분류 문제인 경우 데이터에 있는 각 클래스의 인스턴스 수를 프린트해야하고 클래스가 동등하게 표현되는지 확인해야 한다.

또한 프로덕선에서 사용할 수 없는 대상에 대한 정보를 제공하는 데이터의 기능이 잇는지 확인한다.

### Choose a measure of success

무언가를 통제하려면 관찰할 수 있어야 한다. 프로젝트에서 성공하려면 먼저 성공 정확도가 무엇을 의미하는지 정의해야 한다. 정밀도나 재현율 등 성공을 위한 지표는 프로젝트 전반에 걸쳐 당신이 내릴 모든 기술적 선택의 기준이 된다.

또한 성공을 측정하는 데 사용할 사용자 지정 메트릭을 정의해야 하는 경우가 많다. 머신 러닝 성공 지표의 다양성과 다양한 문제 영역과의 관계를 이해하려면 Kaggle에서 데이터 과학 경시 대회를 검색하는 것이 좋다.

## 6.2 Develop a model

진행 상황을 측정하는 방법을 알고나면 모델 개발을 시작할 수 있다.

### 6.2.1 Prepare the data

딥러닝 모델은 일반적으로 데이터를 수집하지 않는다. 데이터 전처리는 원시 데이터를 신경망에 더 잘 적응하도록 만드는 것을 목표로 한다. 여기에는 벡터화, 정규화 또는 누락된 값 처리가 포함된다. 많은 전처리 기술은 도메인에 따라 다르다. 

#### 벡터화

신경망의 모든 입력 및 타깃은 일반적으로 부동 소수점 데이터의 텐서여야 한다. 데이터가 무엇이든 먼저 벡터화르 통해 텐서로 변환해야 한다. 에를 들어 앞에서 원핫인코딩을 사용한 것을 확인할 수 있다.

#### Value 정규화

데이터를 네트워크에 제공하기 전에 각 기능을 독립적으로 정규화하여 표준 편차가 1이고, 평균이 0이 되도록 한다.
 
 일반적으로 상대적으로 큰 값을 가져오는 데이터나 이질적인 데이터를 신경망에 공급하는 것은 안전하지 않다.
 
 그렇게 하면 네트워크 수렴을 방지하는 대규모 그레이디언트 업데이트가 trigger될 수 있다. 네트워킁서 더 쉽게 학습할 수 있도록 데이터에는 ㄷ음과 같은 특성이 있어야한다.
 
 -Take small values : 일반적으로 대부분의 값은 0과1 사이에 있어야 한다.
 
 -Be homogenous : 모든 기능은 거의 동일한 범위의 값을 취해아 한다.
 
 또한 다음과 같은 보다 엄격한 정규화 방식이 일반적이며 항상 필요한 것은 아니지만 도움이 될 수 있다.
 
 -평균이 0이 되도록 각 특성을 독립적으로 정규화한다.
 
 -표준편차가 1이 되도록 각 특성을 독립적으로 정규화한다.
 
때때로 데이터에 누락된 값이 있을 수 있다. 어떠한 기능이 모든 샘플에서 사용되는 것은 아닙니다. 이 기능을 완전히 버릴 수도 있지만 반드시 그럴 필요는 없다.

-기능이 범주형인 경우 : '값이 누락됨'을 의미하는 새 범주를 생성하는 것이 안전하다.

-특성이 숫자인 경우 : '0'같은 임의의 값을 입력하지 말고 데이터세트이 기능에 대한 평균 또는 중앙값으로 박는 것이 좋다. 다른 특성 값이 주어지면 특성 값을 예측하도록 모델을 훈련시킬 수도 있다.

테스트 데이터에서 누락된 범주 기능이 예상되지만 누락된 값이 없는 데이터에 대해 네트워크가 학습된 경우 네트워크는 누락된 값을 무시하는 방법을 학습하지 못할 것이다. 이 상황에서는 누락된 항목이 잇는 훈련 샘플을 인위적으로 생성해야 한다. 일부 훈련 샘플을 여러번 복사하고 테스트 데이터에서 누락될 것으로 예상되는 범주형 기능 중 일부는 삭제한다.

### 6.2.2 Choose an evaluation prtocol
 
 
